<?php
    $database = mysqli_connect('localhost','root','','login_and_register_in_flutter');
    // if(!database){
    //     echo "Database connection failed";
    // }

    // Storing the received JSON into $json variable.
    $json = file_get_contents('php://input');

    //Decode the received Json and store into a variable
    $obj = json_decode($json,true);


    $Name = $obj['Name'];
    $Email = $obj['Emaiil'];
    $Password = $obj['Password'];
    $Phone = $obj['Phone'];

    //checking whether email is already exist or not in table
    $checkSql = "SELECT * FROM user_table WHERE Email = '$Email'";

    $resultsearch=mysqli_query($database,$checkSql);

    //Executing Email check sql query
    //$check = mysqli_fetch_array(mysqli_query($database,$checkSql));

    if(mysqli_num_rows($resultsearch)>0)
    {
           while($row=mysqli_fetch_array($resultsearch))
          {
              $result["success"] = "3";
              $result["message"] = "user Already exist";
              echo json_encode($result);
          }
  }
  else{
        //sql query to insert data into user_table 
        $sql_query = "INSERT INTO user_table (Name,Email,Password,Phone) VALUES ('$Name','$Email','$Password','$Phone')";

        if(mysqli_query($database,$sql_query)){
            $successMsg = 'Successfully Registered';
            $json = json_decode($successMsg);
            echo $json;
        }
        else{
            echo 'Try again';
        }
    }
    mysqli_close($database);

?>
