<?php
    $database = mysqli_connect('localhost','root','','login_and_register_in_flutter');
    

    $Name = $_POST['Name'];
    $Email = $_POST['Email'];
    $Password = $_POST['Password'];
    $Phone = $_POST['Phone'];



    //Registration Code is strat from here

    //checking whether email is already exist or not in table
    $checkSql = "SELECT * FROM user_table WHERE Email = '$Email'";

    $resultsearch=mysqli_query($database,$checkSql);

    //Executing Email check sql query

    if(mysqli_num_rows($resultsearch)>0)
    {
           while($row=mysqli_fetch_array($resultsearch))
          {
              $result  = 'User Already Exist';
              $failedMsg = json_encode($result);
              echo $failedMSG;
          }
  }
  else{
        //sql query to insert data into user_table 
        $sql_query = "INSERT INTO user_table (Name,Email,Password,Phone) VALUES ('$Name','$Email','$C','$Phone')";

        if(mysqli_query($database,$sql_query)){
            $successMsg = 'Successfully Registered';
            $json = json_decode($successMsg);
            echo $json;
        }
        else{
            echo 'Try again';
        }
    }

    //Registration code is close here



    //Login section is here // 


    $loginQuery = "SELECT * FROM user_table WHERE Email='$EMAIL' AND Password = '$Password'";

    $login_serch = mysqli_fetch_array(mysqli_query($database,$checkSql));

    if(isset($login_serch)){
        //Successfully login message
        $success_login_msg  = 'Login Success';
        $sucessMSG = json_decode($success_login_msg);
        echo $successMsg;
    }
    else{
        $invalid_match = 'Invalid Login Details: ';
        $failedMSG = json_decode($invalid_match);
        echo $failedMSG;
    }


    //login section is close here // 

    mysqli_close($database);

?>
